# Cortex-OS Green-State Remediation Backlog

1. **Resolve ESLint regressions in toolkit validation tests.** Both `tests/tdd-coach/phase2-comprehensive-validation.test.ts` and `tests/toolkit/comprehensive-validation.test.ts` define a mocked `executeTool` method whose `_params` argument is never used, tripping the `@typescript-eslint/no-unused-vars` rule and causing `pnpm lint` to fail. Either remove the parameter or assert against it so the mocks comply with lint policy. 【F:tests/tdd-coach/phase2-comprehensive-validation.test.ts†L27-L56】【F:tests/toolkit/comprehensive-validation.test.ts†L27-L56】【f4bed5†L1-L12】
2. **Fix Nx smart typecheck prerequisites.** Running `pnpm typecheck` currently emits `fatal: bad revision 'origin/main'` before skipping the run, which means the incremental smart wrapper cannot diff against the expected upstream branch. Configure a fallback base (e.g., fetch `origin/main` in CI or allow overriding the base revision) so typechecks can execute deterministically. 【2c0a64†L1-L12】
3. **Batch GraphRAG memory lookups.** The Qdrant result hydration loop in `GraphRAGService` re-queries SQLite for each point sequentially, which is flagged as a high-severity performance bottleneck. Replace the per-point `SELECT` with a batched `IN` query (or other bulk loader) and add regression tests for large result sets. 【F:issues.json†L2-L11】
4. **Harden GPU embedding cleanup.** `GPUAcceleration.ts` lacks explicit memory disposal, raising a high-severity risk of GPU leaks during embedding generation. Implement lifecycle hooks to release GPU buffers and cover the behavior with leak-detection tests. 【F:issues.json†L12-L21】
5. **Eliminate SQL injection risk in `LocalMemoryProvider`.** Dynamic query construction concatenates conditions directly into SQL, leaving inputs unsanitized. Refactor the provider to use parameterized statements and add security tests for malicious inputs. 【F:issues.json†L22-L31】
6. **Decompose oversized GraphRAG query pipeline.** The main `query` routine in `GraphRAGService` spans over 260 lines and mixes validation, graph expansion, and context assembly, creating a high-severity maintainability issue. Break it into cohesive helpers with targeted unit tests. 【F:issues.json†L32-L40】
7. **Simplify `LocalMemoryProvider` construction.** The provider constructor handles extensive setup (database, Qdrant, queues) inline, making it hard to test or extend. Extract initialization phases into dedicated methods and cover them with unit tests. 【F:issues.json†L42-L50】
8. **Strengthen MCP connector error handling.** The connector manager swallows refresh failures by merely emitting a warning, leaving consumers unaware of critical outages. Introduce retries/circuit breakers and assert on failure paths in tests. 【F:issues.json†L52-L60】

